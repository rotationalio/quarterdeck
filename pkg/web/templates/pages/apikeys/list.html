{{ template "page.html" . }}
{{ define "content" }}
<div class="header">
  <div class="header-body">
    <div class="row align-items-center">
      <div class="col">
        <h6 class="header-pretitle">
          Access Management
        </h6>
        <h1 class="header-title text-truncate">
          Manage your API keys
        </h1>
      </div>
      <div class="col-auto">
        <button class="btn btn-primary ms-1">
          <i class="fas fa-plus me-1"></i> Create API Key
        </button>
      </div>
    </div>
  </div>
</div>

<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="card-title">Allocated API Keys</h5>
      </div>
      <div class="card-body mt-0 pt-0">
        <table id="apikeys-table" class="table table-striped table-hover w-100">
          <thead>
            <tr>
              <th>Description</th>
              <th>Client ID</th>
              <th>Date Created</th>
              <th>Last Used</th>
            </tr>
          </thead>
        </table>
      </div>
    </div>
  </div>
</div>
{{ end }}

{{ define "appcode" }}
<script src="/static/js/vendor/datatables.min.js"></script>
<script>
$(document).ready(function() {
  $("#apikeys-table").DataTable({
    destroy: true,
    ajax: {
      url: "/v1/apikeys",
      error: function (xhr, error, thrown) {
        const message = xhr.responseJSON?.error;
        notyf.error("Error: " + message  || 'An unknown error occurred');
        console.error(xhr.responseJSON);
      },
    },
  });
});
</script>
{{ end }}